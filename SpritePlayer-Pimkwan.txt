/*
 * [Activity-1]: SpritePlayer Class
 *
 * Loads a sequence of images from a config file and plays them
 * as an animation.
 */

class SpritePlayer {
  
  PImage[] frames;
  int currentFrame;
  int frameRate; // How fast to play
  int frameTimer;
  
  boolean isLoop; // [Source 249]
  boolean isPlaying;
  
  SpritePlayer(String configPath) {
    // TODO: [Source 246] Load sprite config from the file
    // Read the file, find all image paths, and load them
    // into the 'frames' array
    
    // Example:
    // String[] lines = loadStrings(configPath);
    // frames = new PImage[lines.length];
    // for (int i = 0; i < lines.length; i++) {
    //   frames[i] = loadImage(lines[i]);
    // }
    
    currentFrame = 0;
    frameRate = 5; // e.g., 5 frames of game logic per animation frame
    frameTimer = 0;
    isLoop = true;
    isPlaying = true;
  }
  
  void setLoop(boolean loop) {
    this.isLoop = loop;
  }
  
  boolean isPlaying() {
    return isPlaying;
  }
  
  void play() {
    this.isPlaying = true;
    this.currentFrame = 0;
  }
  
  void update() {
    if (!isPlaying) return;
    
    frameTimer++;
    if (frameTimer > frameRate) {
      frameTimer = 0;
      currentFrame++;
      
      if (currentFrame >= frames.length) {
        if (isLoop) {
          currentFrame = 0; // Loop back
        } else {
          // [Source 249] Stop at the end if not looping
          currentFrame = frames.length - 1;
          isPlaying = false;
        }
      }
    }
  }
  
  void render(float x, float y) {
    // TODO: Draw the current animation frame
    // image(frames[currentFrame], x, y);
  }
}